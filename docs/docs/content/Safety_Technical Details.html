<!DOCTYPE html>
<html><head></head><body><div class="main-panel wiki-content">
<div class="description">
<div class="header-wrapper" style="max-width: initial">
<!-- breadcrumbs could be implemented and inserted here -->
<div></div>

</div>
<div class="header-wrapper">
<div class="title-wrapper">
<div class="title">
<h1 style="display: flex; align-items: center;">
                                        Safety - Comprehensive Guide of Safety
                                    </h1>
</div>
<div class="row" style="display: flex;padding: 0; ">

</div>
</div>
</div>
<div class="content-wrapper">
<style>@media (prefers-color-scheme: dark) { }</style>
<div class="toc-macro client-side-toc-macro conf-macro output-block" data-cssliststyle="none" data-hasbody="false" data-headerelements="H1,H2,H3,H4,H5,H6" data-layout="default" data-local-id="a44a8f6d-d4a0-462f-b138-89bedd915e7d" data-macro-id="10441671-dde5-4153-97e7-c70e90e9861d" data-macro-name="toc" data-numberedoutline="false" data-structure="list">
<style>[data-colorid=h4lkflvg96]{color:#0747a6} html[data-color-mode=dark] [data-colorid=h4lkflvg96]{color:#5999f8}[data-colorid=qikn4gdd11]{color:#0747a6} html[data-color-mode=dark] [data-colorid=qikn4gdd11]{color:#5999f8}[data-colorid=p2wtjw861d]{color:#0747a6} html[data-color-mode=dark] [data-colorid=p2wtjw861d]{color:#5999f8}[data-colorid=fnv50af9t7]{color:#0747a6} html[data-color-mode=dark] [data-colorid=fnv50af9t7]{color:#5999f8}[data-colorid=p0zdvi2ni3]{color:#0747a6} html[data-color-mode=dark] [data-colorid=p0zdvi2ni3]{color:#5999f8}[data-colorid=cfmucevj0w]{color:#0747a6} html[data-color-mode=dark] [data-colorid=cfmucevj0w]{color:#5999f8}</style>
<ul>
<li><a class="not-blank" href="#DetailedLookAtOurPrivacyModules"><span data-colorid="p2wtjw861d">Detailed Look At Our Privacy Modules</span></a>
<ul>
<li><a class="not-blank" href="#ListofMethodsforUnstructuredTextData"><span data-colorid="fnv50af9t7">List of Methods for Unstructured Text Data</span></a>
<ul>
<li><a class="not-blank" href="#SafetyAnalyze">Safety Analyze</a></li>
<li><a class="not-blank" href="#SafetyAnonymize">Safety Anonymize</a></li>
</ul></li>
<li><a class="not-blank" href="#ListofMethodsforImageData"><span data-colorid="cfmucevj0w">List of Methods for Image Data</span></a>
<ul>
<li><a class="not-blank" href="#ImageAnalyze">Image Analyze</a></li>
<li><a class="not-blank" href="#ImageGenerate">Image Generate</a></li>
<li><a class="not-blank" href="#NudityAnalyze">Nudity Analyze</a></li>
</ul></li>
<li><a class="not-blank" href="#ListofmethodsforVideoData"><span data-colorid="qikn4gdd11">List of methods for Video Data</span></a>
<ul>
<li><a class="not-blank" href="#SafetyVideo">Safety Video</a></li>
<li><a class="not-blank" href="#NudityVideo">Nudity Video</a></li>
</ul></li>
</ul></li>
<li><a class="not-blank" href="#ModelsUsed"><span data-colorid="p0zdvi2ni3">Models Used</span></a>
<ul>
<li><a class="not-blank" href="#DetoxifyModel"><u>Detoxify Model</u></a></li>
<li><a class="not-blank" href="#NSFWGantman"><u>NSFW Gantman</u></a></li>
<li><a class="not-blank" href="#NudeNetModel"><u>NudeNet Model</u></a></li>
</ul></li>
<li><a class="not-blank" href="#SafetyByExamples"><span data-colorid="h4lkflvg96">Safety - By Examples</span></a>
<ul>
<li><a class="not-blank" href="#UnstructuredTextSafety"><u>Unstructured Text Safety</u></a></li>
<li><a class="not-blank" href="#ImageSafety"><u>Image Safety</u></a></li>
</ul></li>
</ul>
</div>
<h2 id="DetailedLookAtOurPrivacyModules"><span data-colorid="p2wtjw861d">Detailed Look At Our Privacy Modules</span><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h2>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="0f8a0d4f-30d5-4741-89c8-8a84654249fc" data-macro-name="expand" id="expander-133257796">
<div class="expand-control" id="expander-control-133257796" onclick="expandContent('expander-content-133257796', 'expander-control-133257796')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Unstructured Text</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-133257796">
<h3 id="ListofMethodsforUnstructuredTextData"><span data-colorid="fnv50af9t7">List of Methods for Unstructured Text Data</span><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h3>
<div class="table-wrap dt626732093" style="width: 100%; margin: 10px auto 0px; max-width: 760px;">
<div style="overflow-x: auto;"><table border="1" class="confluenceTable" data-layout="default" data-local-id="ac5c6854-043c-41a7-b77e-dc9468838661" style="border-collapse: collapse; width: 100%;">
<tbody>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Method</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Description</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Request</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Response</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="SafetyAnalyze">Safety Analyze<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Detects profane words in each text and gives JSON report as an output.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input text</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>JSON Report</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="SafetyAnonymize">Safety Anonymize<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Anonymizing detected profane words in each text and gives anonymized text as an output.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Anonymized Text</p></td>
</tr>
</tbody>
</table></div>
<style>html .dt626732093 table {min-width:0px;}</style>
</div>
</div>
</div>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="c7509282-df2c-4de3-927e-687f225525c5" data-macro-name="expand" id="expander-1730598721">
<div class="expand-control" id="expander-control-1730598721" onclick="expandContent('expander-content-1730598721', 'expander-control-1730598721')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Image</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-1730598721">
<h3 id="ListofMethodsforImageData"><span data-colorid="cfmucevj0w">List of Methods for Image Data</span> <a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h3>
<div class="table-wrap dt-1284670463" style="width: 100%; margin: 10px auto 0px; max-width: 760px;">
<div style="overflow-x: auto;"><table border="1" class="confluenceTable" data-layout="default" data-local-id="4be37fbb-d44e-4d2a-b9da-31178a504019" style="border-collapse: collapse; width: 100%;">
<tbody>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Method</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Description</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Request</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Response</p></td>
</tr>
<tr>
<td class="confluenceTd" rowspan="2" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="ImageAnalyze">Image Analyze<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" rowspan="2" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Detects NSFW image based on parameters (porn, sexy, neutral, drawings, hentai) in input image.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input Image</p></td>
<td class="confluenceTd" rowspan="2" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>JSON containing the detection scores and byte64 code of output image, all in JSON format</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Optional Fields:  portfolio, account</p></td>
</tr>
<tr>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="ImageGenerate">Image Generate<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Generates an image based on the prompt given as a input.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input Prompt</p></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Gives output image based on the prompt and also checks the image using above image analyze api. Gives JSON containing the detection scores and byte64 code of output image, all in JSON format</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p> </p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Optional Fields:  portfolio, account</p></td>
</tr>
<tr>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="NudityAnalyze">Nudity Analyze<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Detects the specific parts of nudity in the given image.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input Image</p></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Gives byte64 image blurring the detected nudity parts.</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p> </p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Optional Fields:  portfolio, account</p></td>
</tr>
</tbody>
</table></div>
<style>html .dt-1284670463 table {min-width:0px;}</style>
</div>
</div>
</div>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="3ba19031-0634-4c5c-abe6-41241bb0c4fa" data-macro-name="expand" id="expander-266300577">
<div class="expand-control" id="expander-control-266300577" onclick="expandContent('expander-content-266300577', 'expander-control-266300577')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Video</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-266300577">
<h3 id="ListofmethodsforVideoData"><span data-colorid="qikn4gdd11">List of methods for Video Data</span><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h3>
<div class="table-wrap dt-777637637" style="width: 100%; margin: 10px auto 0px; max-width: 760px;">
<div style="overflow-x: auto;"><table border="1" class="confluenceTable" data-layout="default" data-local-id="12d427da-7108-4ff9-9683-ec9ef40f300b" style="border-collapse: collapse; width: 100%;">
<tbody>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Method</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Description</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Request</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Response</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="SafetyVideo">Safety Video<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Detects NSFW video based on parameters (porn, sexy, neutral, drawings, hentai) in input video.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input Video</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Gives blurred output video based on the scores for NSFW parameter. Gives byte64 video.</p></td>
</tr>
<tr>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><h6 id="NudityVideo">Nudity Video<a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h6></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Detects the specific parts of nudity in the given video.</p></td>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Mandatory Fields: Input video</p></td>
<td class="confluenceTd" rowspan="3" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Gives the byte64 video blurring the detected nudity parts.</p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p> </p></td>
</tr>
<tr>
<td class="confluenceTd" style="border: 1px solid #ddd; padding: 8px; text-align: left;"><p>Optional Fields:  portfolio, account</p></td>
</tr>
</tbody>
</table></div>
<style>html .dt-777637637 table {min-width:0px;}</style>
</div>
</div>
</div>
<h2 id="ModelsUsed"><span data-colorid="p0zdvi2ni3">Models Used</span><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h2>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="4e3037fc-8c62-426b-a160-1643d38b16ba" data-macro-name="expand" id="expander-555859800">
<div class="expand-control" id="expander-control-555859800" onclick="expandContent('expander-content-555859800', 'expander-control-555859800')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Detoxify</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-555859800">
<h4 id="DetoxifyModel"><u>Detoxify Model</u><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h4>
<p>It is a machine learning model that can identify and classify toxic text. It is a powerful tool that can be used to help protect people from online abuse. Detoxify is able to identify a wide range of toxic content, including hate speech, threats, and self-harm. It can also identify more subtle forms of toxicity, such as sarcasm and insults.<br/><br/><strong>How it Works:</strong></p>
<ol start="1">
<li><p><strong>Text Preprocessing:</strong> The input text is cleaned and tokenized into a numerical representation.  </p></li>
<li><p><strong>Feature Extraction:</strong> A pre-trained language model, like BERT or RoBERTa, extracts semantic and syntactic features from the tokenized text.</p></li>
<li><p><strong>Toxicity Classification:</strong> A classifier, often a neural network, is trained to predict the likelihood of toxicity based on the extracted features. This classifier is trained on a large dataset of labeled toxic and non-toxic text.  </p></li>
<li><p><strong>Output:</strong> The model outputs a probability score for each toxicity category, such as hate speech, threats, or offensive language.<br/></p></li>
</ol>
</div>
</div>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="73e1afbb-746f-42c2-b80b-1eab0635f32b" data-macro-name="expand" id="expander-192847615">
<div class="expand-control" id="expander-control-192847615" onclick="expandContent('expander-content-192847615', 'expander-control-192847615')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">NSFW Gantman</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-192847615">
<h4 id="NSFWGantman"><u>NSFW Gantman</u><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h4>
<p>This AI-powered tool acts as a digital guardian, scanning images and videos to identify and flag NSFW (Not Safe For Work) material.</p>
<p>NSFW Gantman is a machine learning model designed to identify sexually explicit content in images. It works by:</p>
<ol start="1">
<li><p><strong>Image Analysis:</strong> The model analyzes the image pixel by pixel, looking for specific patterns and features associated with explicit content.</p></li>
<li><p><strong>Feature Extraction:</strong> It extracts important features from the image, such as edges, textures, and color patterns.</p></li>
<li><p><strong>Classification:</strong> Using these extracted features, the model classifies the image as either safe or explicit.</p></li>
</ol>
<p>The model is trained on a large dataset of images, allowing it to learn to recognize explicit content with high accuracy. It is widely used in content moderation systems to filter out harmful content and protect users.</p>
</div>
</div>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="9706240c-3e0d-438d-943c-5e6c39c2170b" data-macro-name="expand" id="expander-1346612368">
<div class="expand-control" id="expander-control-1346612368" onclick="expandContent('expander-content-1346612368', 'expander-control-1346612368')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Nudenet</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-1346612368">
<h4 id="NudeNetModel"><u>NudeNet Model</u><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h4>
<p>It aims to provide a responsible AI solution for identifying and censoring nudity in various applications, which is particularly important in contexts where content moderation is necessary, such as social media platforms, adult content filtering, and user-generated content sites.</p>
<p><strong><u>Classes Detected:</u></strong></p>
<p>NudeNet can identify a variety of classes related to nudity, including:</p>
<ul>
<li><p>FEMALE_GENITALIA_EXPOSED</p></li>
<li><p>MALE_BREAST_EXPOSED</p></li>
<li><p>BUTTOCKS_EXPOSED</p></li>
<li><p>FACE_FEMALE</p></li>
<li><p>and many more.</p></li>
</ul>
</div>
</div>
<h2 id="SafetyByExamples"><span data-colorid="h4lkflvg96">Safety - By Examples</span><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h2>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="0606043a-5b12-436a-a494-259e13548f16" data-macro-name="expand" id="expander-1198384416">
<div class="expand-control" id="expander-control-1198384416" onclick="expandContent('expander-content-1198384416', 'expander-control-1198384416')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Text</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-1198384416">
<h4 id="UnstructuredTextSafety"><u>Unstructured Text Safety</u><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h4><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size" original-width="1207" style="max-width: 760px;" width="439"><img alt="image-20241114-091013.png" class="confluence-embedded-image image-center cursor-pointer" src="/docs/images\unknown-attachment" title="image-20241114-091013.png"/></span>
<ul>
<li><p>The AI model processes the input text and generates a safety analysis report. This report includes:</p>
<ul>
<li><p><strong>Profanity Scores:</strong></p>
<ul>
<li><p><strong>Toxicity:</strong> This metric measures the overall toxicity of the text, indicating the likelihood of it being offensive or harmful. In this case, the toxicity score is 0.973, suggesting high toxicity.</p></li>
<li><p><strong>Severe Toxicity:</strong> This metric measures the severity of the toxic content, indicating the potential for extreme harm. The score of 0.014 suggests a low level of severe toxicity.</p></li>
<li><p><strong>Obscene:</strong> This metric measures the obscenity of the content, indicating the presence of explicit or vulgar language. The score of 0.945 suggests high obscenity.</p></li>
<li><p><strong>Threat:</strong> This metric measures the threat level of the content, indicating the potential for violence or harm. The score of 0.001 suggests a very low threat level.</p></li>
</ul></li>
<li><p><strong>Profane Words:</strong></p>
<ul>
<li><p>The model identifies specific profane words present in the text: "bullshit" and "shit."</p></li>
</ul></li>
</ul></li>
</ul>
<ol start="3">
<li><p><strong>Safety Output:</strong></p></li>
</ol>
<ul>
<li><p>Based on the analysis, the AI model flags the input text as unsafe due to its high toxicity and obscenity levels.</p></li>
</ul>
<p> </p>
</div>
</div>
<div class="expand-container conf-macro output-block" data-hasbody="true" data-macro-id="ca8d59e6-ff7c-44e7-bab9-2bc99579fff0" data-macro-name="expand" id="expander-10411294">
<div class="expand-control" id="expander-control-10411294" onclick="expandContent('expander-content-10411294', 'expander-control-10411294')">
<span class="expand-control-icon icon"> </span><span class="expand-control-text">Image</span>
</div>
<div class="expand-content expand-hidden" id="expander-content-10411294">
<h4 id="ImageSafety"><u>Image Safety</u><a aria-label-top="Copy link to heading" class="anchor-copy-link anchor-tooltip" target="_blank"></a></h4>
<p> The below provided image showcases the capabilities of an AI-powered image analysis tool. It demonstrates how the tool can effectively identify and process explicit content within an image.</p>
<ul>
<li><p><strong>Original Image:</strong> The original image contains explicit content.</p></li>
<li><p><strong>Processed Image:</strong> The tool has successfully identified and obscured the explicit parts of the image, rendering it safe for public viewing.</p></li>
</ul>
<p><strong>Pie Chart Analysis:</strong></p>
<p>The pie chart provides a detailed breakdown of the image's content categories as determined by the AI model:</p>
<ul>
<li><p><strong>Drawings:</strong> A small portion of the image consists of drawings, which are generally considered safe content.</p></li>
<li><p><strong>Hentai:</strong> A larger portion of the image is classified as hentai, a genre of anime and manga that often features explicit sexual content.</p></li>
<li><p><strong>Neutral:</strong> A relatively small portion is categorized as neutral, indicating content that is neither explicit nor suggestive.</p></li>
<li><p><strong>Porn:</strong> A significant portion of the image is classified as pornographic, meaning it contains explicit sexual content.</p></li>
<li><p><strong>Sexy:</strong> A small portion is categorized as sexy, suggesting suggestive but not explicitly sexual content.</p></li>
</ul><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size" original-width="719" style="max-width: 760px;" width="173"><img alt="image (13).png" class="confluence-embedded-image image-center cursor-pointer" data-height="514" data-linked-resource-container-id="1151303933" data-linked-resource-container-version="4" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image (13).png" data-linked-resource-id="1151762622" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="5e8517fa-a784-40b6-be6e-4b26861645e2" data-media-type="file" data-thumbnail-url="/content/58f1bf1b-24d0-4a88-8e47-edf6a46686f0/207815356/228720962/232359155/1151303933/media/ZUtYZXp4bXpfSmozQUJNSXoxTTZ2WG9TUzJlSkNCUVBTZXlFV1pUb3N2OD0=.TlRobU1XSm1NV0l0TWpSa01DMDBZVGc0TFRobE5EY3RaV1JtTm1FME5qWTRObVl3Lk1UY3pPVFEyTlRBMk1qWTRPQT09LmJ3PT0uZEdoMWJXSnVZV2xzY3c9PS5NVEUxTVRNd016a3pNdz09LmFXMWhaMlVsTWpBb01UTXBMbkJ1Wnc9PS5kbVZ5YzJsdmJqMHhKbTF2WkdsbWFXTmhkR2x2YmtSaGRHVTlNVGN6TVRVM05EYzFNVGt5T1NaallXTm9aVlpsY25OcGIyNDlNU1poY0drOWRqSW1kMmxrZEdnOU1UY3pKbWhsYVdkb2REMHhNak09/image__13_.png" data-unresolved-comment-count="0" data-width="719" loading="lazy" name="image-attachment" src="/docs/images\image__13_.png" style="width: 173px;" width="173"/><span class="image-caption"><p>Processed Image</p></span></span><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size" original-width="502" style="max-width: 760px;" width="169"><img alt="image (12)-20241114-085626.png" class="confluence-embedded-image image-center cursor-pointer" data-height="383" data-linked-resource-container-id="1151303933" data-linked-resource-container-version="4" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image (12)-20241114-085626.png" data-linked-resource-id="1152679951" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="d6a2f545-58cf-46db-952a-57fb6aaefa3a" data-media-type="file" data-thumbnail-url="/content/58f1bf1b-24d0-4a88-8e47-edf6a46686f0/207815356/228720962/232359155/1151303933/media/YmN3YjRrdGhiYVFtNjdBdmRUdDNDRGJMZUpMLTJUUGJhai1CMnZKRHlORT0=.TlRobU1XSm1NV0l0TWpSa01DMDBZVGc0TFRobE5EY3RaV1JtTm1FME5qWTRObVl3Lk1UY3pPVFEyTlRBMk1qWTRPUT09LmJ3PT0uZEdoMWJXSnVZV2xzY3c9PS5NVEUxTVRNd016a3pNdz09LmFXMWhaMlVsTWpBb01USXBMVEl3TWpReE1URTBMVEE0TlRZeU5pNXdibWM9LmRtVnljMmx2YmoweEptMXZaR2xtYVdOaGRHbHZia1JoZEdVOU1UY3pNVFUzTkRZeE5EZzNOU1pqWVdOb1pWWmxjbk5wYjI0OU1TWmhjR2s5ZGpJbWQybGtkR2c5TVRZNUptaGxhV2RvZEQweE1qaz0=/image__12_-20241114-085626.png" data-unresolved-comment-count="0" data-width="502" loading="lazy" name="image-attachment" src="/docs/images\image__12_-20241114-085626.png" style="width: 169px;" width="169"/><span class="image-caption"><p>Image Analyze Report</p></span></span>
<p> </p>
</div>
</div>
<p> </p>
</div>
<!-- ATTACHMENTS -->

<script>
            document.addEventListener("DOMContentLoaded", () => {
                const wrapper = document.getElementById("attachments-wrapper");
                const button = document.getElementById("toggle-attachments-view-button");
                document.querySelectorAll(".file-full").forEach(el => {
                    el.addEventListener("mouseover", moveTooltip);
                });

                button.addEventListener("click", () => {
                    wrapper.classList.toggle("attachments-wrapper-gallery");
                    wrapper.classList.toggle("attachments-wrapper-list");
                });
            });

            function moveTooltip(e) {
                if (e.target.classList.contains("file-wrapper")) {
                    let docWidth = document.body.clientWidth;
                    let docHeight = document.body.clientHeight;
                    let rect = e.target.getBoundingClientRect();
                    let fileTooltip = e.target.parentElement.querySelector(".file-tooltip")
                    if (fileTooltip) {
                        if (rect.left <= docWidth / 2) {
                            fileTooltip.classList.add("left");
                            fileTooltip.classList.remove("right");
                        } else {
                            fileTooltip.classList.remove("left");
                            fileTooltip.classList.add("right");
                        }
                        if (rect.top <= docHeight / 2) {
                            fileTooltip.classList.add("top");
                            fileTooltip.classList.remove("bottom");
                        } else {
                            fileTooltip.classList.remove("top");
                            fileTooltip.classList.add("bottom");
                        }
                    }
                }
            }

        </script>
<script>
                hideGroup('attachments');
            </script>
<div id="footer-comments-outlet">
<div>

<script>
        function editComment(commentId, el) {
            const commentElement = document.getElementById("comment-" + commentId);
            const commentSelfEditor = document.getElementById("comment-self-editor-" + commentId);
            const commentValue = document.getElementById("comment-" + commentId).getElementsByClassName('data-container').item(0).getAttribute('data-adf-body');
            const editForm = document.getElementById('edit-comment-form-' + commentId);
            const deleteButton = document.getElementById('delete-' + commentId);

            el.hidden = true;
            el.disabled = true;

            deleteButton.hidden = true;
            deleteButton.disabled = true;

            commentElement.querySelectorAll(':scope > div').forEach(div => {
                div.style.display = 'none';
            });

            commentSelfEditor.style.display = 'block';
            commentSelfEditor.disabled = false;
            commentSelfEditor.value = commentValue;

            editForm.style.display = 'block';

            createEditorInstance('comment-self-editor', 'top-edit', '-' + commentId);
            CKEDITOR.instances['comment-self-editor-' + commentId]?.setData(commentValue);
            commentSelfEditor.focus();
        }

        function save(commentId, el) {
            el.disabled = true;

            const csrf = document.getElementById("edit-comment-form-" + commentId).dataset.csrf;
            const commentValue = CKEDITOR.instances['comment-self-editor-' + commentId].getData();
            const commentElement = document.getElementById("comment-" + commentId);

            let url = '/comment?__csrf=' + csrf;

            if (!commentValue) {
                el.disabled = false;
                setError(commentId, 'Comment is required');
            } else if (imageIsLoading(commentValue)) {
                el.disabled = false;
                setError(commentId, 'Image is still loading');
            } else {
                let nameValue = document.getElementById("comment-" + commentId).getElementsByClassName('data-container').item(0).getAttribute('data-adf-username');
                nameValue = escapeHtml(nameValue);
                let finalHtml = '<strong>Added by: ' + nameValue + '</strong>';
                let email = document.getElementById("comment-" + commentId).getElementsByClassName('data-container').item(0).getAttribute('data-adf-email');
                email = escapeHtml(email);
                if (email) {
                    finalHtml += ' <a href="mailto:' + email + '">' + email + '</a>';
                }
                finalHtml += '\n\n' + commentValue;
                req({
                    url: url,
                    contentType: 'application/json',
                    method: 'PUT',
                    data: JSON.stringify({
                        comment: finalHtml,
                        name: nameValue,
                        email: email,
                        type: 'footer',
                        commentId: commentId
                    }),
                    onSuccess: function (xhr) {
                        const commentBody = xhr.response;
                        if (commentBody.includes("data:image/png;base64")) {
                            location.reload();
                            return;
                        }

                        el.disabled = false;
                        hideEditor(commentId);

                        const temp = document.createElement('div');
                        temp.innerHTML = commentBody;

                        let edited = temp.getElementsByClassName('comment-description')[0].innerHTML;
                        const adfBody = temp.getElementsByClassName('data-container')[0].getAttribute('data-adf-body');

                        commentElement.getElementsByClassName('comment-description')[0].innerHTML = edited;
                        commentElement.getElementsByClassName('data-container')[0].setAttribute('data-adf-body', adfBody);
                        showComment(commentElement);
                    },
                    onError: function (xhr) {
                        const contentType = (xhr.getResponseHeader('Content-Type') || '').toLowerCase()
                        let errorMessage = 'Unknown error occurred'
                        if (contentType.startsWith('application/json')) {
                            errorMessage = JSON.parse(xhr.response).message || errorMessage
                        }
                        setError(commentId, errorMessage);
                    }
                })
            }
        }

        function showComment(commentElement) {
            commentElement.querySelectorAll(':scope > div').forEach(div => {
                if (!div.classList.contains('confirmation-modal')) {
                    div.style.display = '';
                }
            });
        }

        function cancel(commentId) {
            hideEditor(commentId);

            const commentElement = document.getElementById("comment-" + commentId);
            showComment(commentElement);
        }

        function hideEditor(commentId) {
            const editForm = document.getElementById('edit-comment-form-' + commentId);
            const deleteButton = document.getElementById('delete-' + commentId);
            const editButton = document.getElementById('edit-' + commentId);
            const editCommentXhrErrorContainer = document.getElementById('edit-comment-xhr-error-container-' + commentId);
            const editCommentXhrErrorMessage = document.getElementById('edit-comment-xhr-error-message-' + commentId);

            editForm.style.display = 'none';
            CKEDITOR.instances['comment-self-editor-' + commentId]?.destroy();
            deleteButton.hidden = false;
            deleteButton.disabled = false;
            editButton.hidden = false;
            editButton.disabled = false
            editCommentXhrErrorContainer.style.display = 'none';
            editCommentXhrErrorMessage.innerText = '';
        }

        function setError(commentId, errorMsg) {
            const editCommentXhrErrorContainer = document.getElementById('edit-comment-xhr-error-container-' + commentId);
            const editCommentXhrErrorMessage = document.getElementById('edit-comment-xhr-error-message-' + commentId);

            editCommentXhrErrorContainer.style.display = 'flex';
            editCommentXhrErrorMessage.innerText = errorMsg;
        }

        function req(opts) {
            const xhr = new XMLHttpRequest();
            const base = window.origin + window.location.pathname;
            xhr.open(opts.method, base + opts.url);

            xhr.onerror = function () {
                opts.onError(xhr);
            };
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    const status = xhr.status;
                    if (status === 200) {
                        opts.onSuccess(xhr);
                    } else {
                        opts.onError(xhr);
                    }
                }
            };

            xhr.setRequestHeader('Content-Type', opts.contentType);
            if (opts.data) {
                xhr.send(opts.data);
            } else {
                xhr.send();
            }
        }

        function imageIsLoading(commentBody) {
            const temp = document.createElement('div')
            temp.innerHTML = commentBody.trim()
            const imgTags = temp.getElementsByTagName('img');
            for (let i = 0; i < imgTags.length; i++) {
                const src = imgTags[i].getAttribute('src');
                if (src === '' || src.includes('blob:http')) {
                    return true;
                }
            }
            return false;
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/'/g, "&#039;");
        }
    </script>
<script>
        function changeMarginForReplies(replies, depth) {
            replies.forEach(reply => {
                let currentMarginLeft = parseInt(reply.style.marginLeft, 10) || 0;
                reply.style.marginLeft = Math.max(currentMarginLeft - depth, 0) + 'px';

                let nestedReplies = document.querySelectorAll('[data-parent-id="' + reply.id.replace('comment-', '') + '"]');
                changeMarginForReplies(nestedReplies, depth);
            });
        }

        function deleteComment(commentId) {
            const deleteDialogButtons = document.querySelectorAll('#confirmation-modal-' + commentId + ' button')
            deleteDialogButtons.forEach(button => {
                button.disabled = true;
            })
            const csrf = document.getElementById("edit-comment-form-" + commentId).dataset.csrf;
            let url = '/comment?__csrf=' + csrf;
            req({
                url: url + "&commentId=" + commentId,
                contentType: 'application/json',
                method: 'DELETE',
                onSuccess: function () {
                    let comment = document.getElementById("comment-" + commentId);

                    const parentCommentId = comment.dataset.parentId || "0";

                    let replies = document.querySelectorAll('[data-parent-id="' + commentId + '"]');
                    replies.forEach(reply => {

                        reply.setAttribute('data-parent-id', parentCommentId);

                        if (parentCommentId === "0") {
                            reply.style.marginLeft = '';
                            reply.removeAttribute('data-parent-id');
                        } else {
                            let currentMarginLeft = parseInt(reply.style.marginLeft, 10) || 0;
                            reply.style.marginLeft = Math.max(currentMarginLeft - 40, 0) + 'px';
                        }

                        let nestedReplies = document.querySelectorAll('[data-parent-id="' + reply.id.replace('comment-', '') + '"]');
                        changeMarginForReplies(nestedReplies, 40);
                    });

                    comment.remove();
                    const overlay = document.getElementById('confirmation-overlay');
                    overlay.style.display = 'none';
                    document.body.classList.remove('overlay-on');
                },
            });

            function req(opts) {
                const xhr = new XMLHttpRequest();
                const base = window.origin + window.location.pathname;
                xhr.open(opts.method, base + opts.url);

                xhr.onerror = function () {
                    opts.onError(xhr);
                };
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4) {
                        const status = xhr.status;
                        if (status === 200) {
                            opts.onSuccess(xhr);
                        } else {
                            opts.onError(xhr);
                        }
                    }
                };

                xhr.setRequestHeader('Content-Type', opts.contentType);
                if (opts.data) {
                    xhr.send(opts.data);
                } else {
                    xhr.send();
                }
            }
        }

        function showDeleteCommentDialog(commentId) {
            const dialog = document.getElementById('confirmation-modal-' + commentId);
            const overlay = document.getElementById('confirmation-overlay');
            dialog.style.display = '';
            overlay.style.display = 'block';
            document.body.classList.add('overlay-on');
        }

        function cancelDelete(commentId) {
            const dialog = document.getElementById('confirmation-modal-' + commentId);
            const overlay = document.getElementById('confirmation-overlay');
            dialog.style.display = 'none';
            overlay.style.display = 'none';
            document.body.classList.remove('overlay-on');
        }
    </script>
<script>
            handleFooterCommentsGroupExpansion();
            hideGroup('comments');

            const commentSortButton = document.getElementById('comment-sort-button');
            commentSortButton.addEventListener('click', function (event) {
                event.stopPropagation();
            });

            function getCurrentSortOrder() {
                return sessionStorage.getItem('commentSortOrder') || "newest";
            }

            function updateSortButton(sortOrder) {
                const commentSortText = document.getElementById("comment-sort-text")
                const commentSortSvg = document.getElementById("comment-sort-svg")
                if (commentSortText != null) {
                    commentSortText.textContent = sortOrder === "newest" ? "Newest first" : "Oldest first";
                }
                if (commentSortSvg != null) {
                    if (sortOrder === "newest") {
                        commentSortSvg.innerHTML = `    <svg role="presentation" width="16px" height="16px" viewBox="0 0 24 24" version="1.1"
         xmlns="http://www.w3.org/2000/svg">
        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <path
                d="M6.8,4.3 C6.6,4.1 6.3,4 6,4 C5.7,4 5.4,4.1 5.2,4.3 L2.3,7.2 C1.9,7.6 1.9,8.3 2.3,8.7 C2.7,9.1 3.3,9.1 3.7,8.7 L5,7.4 L5,19.1 C5,19.6 5.4,20 6,20 C6.6,20 7,19.6 7,19.1 L7,7.4 L8.3,8.7 C8.7,9.1 9.3,9.1 9.7,8.7 C10.1,8.3 10.1,7.6 9.7,7.2 C9.04754611,6.54754611 8.5582057,6.0582057 8.23197876,5.73197876 C7.91376126,5.41376126 7.436435,4.936435 6.8,4.3 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"
                transform="translate(6.000000, 12.000000) rotate(180.000000) translate(-6.000000, -12.000000) "></path>
            <path
                d="M21,5 L13,5 C12.4,5 12,5.4 12,6 C12,6.6 12.4,7 13,7 L21,7 C21.6,7 22,6.6 22,6 C22,5.4 21.6,5 21,5 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
            <path
                d="M13,13 L18,13 C18.6,13 19,12.6 19,12 C19,11.4 18.6,11 18,11 L13,11 C12.4,11 12,11.4 12,12 C12,12.6 12.4,13 13,13 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
            <path
                d="M13,19 L16,19 C16.6,19 17,18.6 17,18 C17,17.4 16.6,17 16,17 L13,17 C12.4,17 12,17.4 12,18 C12,18.6 12.4,19 13,19 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
        </g>
    </svg>
`;
                    } else {
                        commentSortSvg.innerHTML = `    <svg role="presentation" width="16px" height="16px" viewBox="0 0 24 24" version="1.1"
         xmlns="http://www.w3.org/2000/svg">
        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <path
                d="M7.8,4.3 C7.6,4.1 7.3,4 7,4 C6.7,4 6.4,4.1 6.2,4.3 L3.3,7.2 C2.9,7.6 2.9,8.3 3.3,8.7 C3.7,9.1 4.3,9.1 4.7,8.7 L6,7.4 L6,19.1 C6,19.6 6.4,20 7,20 C7.6,20 8,19.6 8,19.1 L8,7.4 L9.3,8.7 C9.7,9.1 10.3,9.1 10.7,8.7 C11.1,8.3 11.1,7.6 10.7,7.2 C10.0475461,6.54754611 9.5582057,6.0582057 9.23197876,5.73197876 C8.91376126,5.41376126 8.436435,4.936435 7.8,4.3 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
            <path
                d="M21,17 L13,17 C12.4,17 12,17.4 12,18 C12,18.6 12.4,19 13,19 L21,19 C21.6,19 22,18.6 22,18 C22,17.4 21.6,17 21,17 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
            <path
                d="M13,13 L18,13 C18.6,13 19,12.6 19,12 C19,11.4 18.6,11 18,11 L13,11 C12.4,11 12,11.4 12,12 C12,12.6 12.4,13 13,13 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
            <path
                d="M13,7 L16,7 C16.6,7 17,6.6 17,6 C17,5.4 16.6,5 16,5 L13,5 C12.4,5 12,5.4 12,6 C12,6.6 12.4,7 13,7 Z"
                id="Path" fill="currentColor" fill-rule="nonzero"></path>
        </g>
    </svg>
`;
                    }
                }
            }

            function sortTabs() {
                const commentsTab = document.querySelector("#comments");
                if (commentsTab) {
                    const commentListContainer = document.getElementById("comment-list");
                    let comments = Array.from(commentListContainer.children);

                    const extractEpoch = commentElement => {
                        return +commentElement.querySelector('.comment-title-date.utc-date-time')?.getAttribute('data-date-time');
                    }

                    let mainComments = comments.filter(comment =>
                        comment.nodeName === 'DIV' &&
                        (!comment.dataset.parentId || comment.classList.contains('new-comment'))
                    );
                    if (getCurrentSortOrder() === "newest") {
                        mainComments.sort((commentA, commentB) => {
                            return extractEpoch(commentB) - extractEpoch(commentA);
                        });
                    } else {
                        mainComments.sort((commentA, commentB) => {
                            return extractEpoch(commentA) - extractEpoch(commentB);
                        });
                    }

                    function getRepliesForComment(parentId) {
                        return comments.filter(comment => comment.dataset.parentId === parentId);
                    }

                    function appendReplies(commentId) {
                        let replies = getRepliesForComment(commentId);

                        replies.forEach(reply => {
                            commentListContainer.appendChild(reply);
                            appendReplies(reply.id.replace('comment-', ''));
                        });
                    }

                    mainComments.forEach(mainComment => {
                        const mainCommentId = mainComment.id.replace('comment-', '');
                        commentListContainer.appendChild(mainComment);
                        appendReplies(mainCommentId);
                    });
                }
            }

            updateSortButton(getCurrentSortOrder());
            sortTabs();

            commentSortButton.style.display = localStorage.getItem("comments-hidden") ? 'none' : '';

            document.getElementById("comment-sort-button").addEventListener("click", () => {
                const newSortOrder = getCurrentSortOrder() === "newest" ? "oldest" : "newest";

                sessionStorage.setItem('commentSortOrder', newSortOrder);

                sortTabs();
                updateSortButton(newSortOrder);
            });

            function handleFooterCommentsGroupExpansion() {
                const element = document.querySelector('.expandable-group-footer-comments');
                const icon = element.children[0];
                const parent = element.parentElement;
                const content = parent.children[1];
                const groupBy = element.children[2];
                let display = content.style.display;
                if (display === 'none') {
                    display = content.classList.contains('display-block') ? 'block' : 'flex';
                }

                element.addEventListener('click', () => {
                    if (icon.classList.contains('expanded')) {
                        icon.classList.remove('expanded');
                        icon.classList.add('collapsed');
                        content.style.display = 'none';
                        groupBy.style.display = 'none';
                        localStorage.setItem(parent.id + '-hidden', 'true');
                    } else {
                        icon.classList.remove('collapsed');
                        icon.classList.add('expanded');
                        content.style.display = display;
                        groupBy.style.display = 'inline-flex';
                        localStorage.removeItem(parent.id + '-hidden');
                    }
                }, false);
            }
        </script>
<script>
        let commentEditorContainer = undefined;
        let commentEditor = undefined;

        CKEDITOR.config.toolbar = [
            {name: 'clipboard', items: ['Undo', 'Redo']},
            {name: 'styles', items: ['Format']},
            {
                name: 'basicstyles',
                items: ['Bold', 'Italic', 'Underline', 'Strike', 'Code', 'Subscript', 'Superscript', 'RemoveFormat']
            },
            {name: 'colors', items: ['TextColor']},
            {
                name: 'paragraph',
                items: ['BulletedList', 'NumberedList', '-', 'Blockquote']
            },
            {name: 'links', items: ['Link', 'Unlink']},
            {name: 'insert', items: ['EasyImageUpload', 'HorizontalRule']},
        ];
        CKEDITOR.config.allowedContent = true;
        CKEDITOR.config.fillEmptyBlocks = false;
        CKEDITOR.config.entities_greek = false;
        CKEDITOR.config.entities_latin = false;
        CKEDITOR.config.entities_additional = '';
        CKEDITOR.config.removePlugins = 'image';
        CKEDITOR.config.extraPlugins = ['confluence-data-macro', 'confluence-information-macro', 'uploadimage', 'autolink'];
        CKEDITOR.config.cloudServices_uploadUrl = '/content/image';
        CKEDITOR.config.cloudServices_tokenUrl = '/content/token';
        CKEDITOR.config.easyimage_toolbar = ['EasyImageAlt'];
        CKEDITOR.config.colorButton_colorsPerRow = 7;
        CKEDITOR.config.colorButton_historyRowLimit = 0;
        CKEDITOR.config.colorButton_colors =
            'Dark gray/172B4D,' +
            'Dark blue/0747A6,' +
            'Dark teal/008DA6,' +
            'Dark green/006644,' +
            'Orange/FF991F,' +
            'Dark red/BF2600,' +
            'Dark purple/403294,' +
            'Light gray/97A0AF,' +
            'Blue/4C9AFF,' +
            'Teal/00B8D9,' +
            'Green/36B37E,' +
            'Yellow/FFC400,' +
            'Red/FF5630,' +
            'Purple/6554C0,' +
            'White/ffffff,' +
            'Light blue/B3D4FF,' +
            'Light teal/B3F5FF,' +
            'Light green/ABF5D1,' +
            'Light yellow/FFF0B3,' +
            'Light red/FFBDAD,' +
            'Light purple/EAE6FF';
        CKEDITOR.config.title = false;

        CKEDITOR.config.contentsCss = ['/static/ckeditor/skins/moono-lisa/editor-confluence.css',
            '/static/css/styles-min-ec1224e2d5fb8052f0c0567cb6ef2897.css',
            '/static/css/not-compressible-styles.min-29a8d7561f5fa345ff1fbab53507d766.css',
            '/static/css/confluence/external-styles-min-ac35853f9c76f672bd2ddf838241e3a6.css',
            '/static/css/confluence/external-styles-new-min-11d7fb2030dff0c4dda2316095967bf5.css']

        CKEDITOR.config.contentsCss.push('/static/css/styles-dark-b4931f80bd4104e17a20f8fc53fb2d6e.css');
        CKEDITOR.config.contentsCss.push('/static/css/confluence/external-styles-dark-41ced8311a3e3b375a3e38e068cfbb3e.css');
        CKEDITOR.config.colorButton_contentsCss = ['/static/ckeditor/skins/moono-lisa/editor-color-button-dark.css'];
        CKEDITOR.dtd.$removeEmpty.span = false;
        CKEDITOR.dtd.$removeEmpty.i = false;
        CKEDITOR.dtd.$removeEmpty.strong = false;
        CKEDITOR.dtd.line = {};
        CKEDITOR.dtd.rect = {};
        CKEDITOR.dtd.$empty.line = true;
        CKEDITOR.dtd.$empty.rect = true;
        //TODO instead of following line, just do not include this plugin when building final package
        // CKEDITOR.config.removePlugins = 'showborders,floatingspace,maximize,resize';
        const editor = document.getElementById('editor');
        CKEDITOR.disableAutoInline = true;

        var head = document.getElementsByTagName('head')[0];
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '/static/ckeditor/skins/moono-lisa/editor-confluence.css';
        link.media = 'all';
        CKEDITOR.on('instanceReady', function () {
            head.appendChild(link);
        });
        CKEDITOR.on('destroy', function () {
            head.removeChild(link);
        })

        function createEditorInstance(name, top, suffix) {
            commentEditor = document.getElementById(name + suffix);
            CKEDITOR.replace(name + suffix, {
                removePlugins: 'elementspath'
            });
        }
    </script>
<script>
        // emailRegExp from https://html.spec.whatwg.org/multipage/input.html#valid-e-mail-address
        const emailRegExp = /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

        function setupEmailValidation(suffix = '') {
            const emailInput = document.getElementById('comment-email' + suffix);
            const emailError = document.getElementById('email-error' + suffix);
            const saveButton = document.getElementById('submit-comment' + suffix);
            const usernameInput = document.getElementById('comment-username' + suffix);
            const usernameError = document.getElementById('name-error' + suffix);

            function isEmailValid(email) {
                return emailRegExp.test(email);
            }

            function validateForm() {
                const isEmailValidOrEmpty = isEmailValid(emailInput.value) || emailInput.value === '';
                emailError.style.display = isEmailValidOrEmpty ? 'none' : 'block';
                emailInput.classList.toggle('email-error', !isEmailValidOrEmpty);
                emailInput.style.border = isEmailValidOrEmpty ? '' : '2px solid red';

                const isUsernameNotEmpty = usernameInput.value.trim() !== '';
                usernameError.style.display = isUsernameNotEmpty ? 'none' : 'block';
                usernameInput.classList.toggle('name-error', !isUsernameNotEmpty);
                usernameInput.style.border = isUsernameNotEmpty ? '' : '2px solid red';

                saveButton.disabled = !isUsernameNotEmpty || !isEmailValidOrEmpty;
                saveButton.style.cursor = saveButton.disabled ? 'not-allowed' : 'pointer';
            }

            emailInput.addEventListener('blur', validateForm);
            usernameInput.addEventListener('blur', validateForm);
        }

        document.addEventListener('DOMContentLoaded', function () {
            setupEmailValidation();
        })

        function addComment(suffix, openEditor) {
            const replyToComment = suffix !== '';
            const trigger = replyToComment ? document.getElementById('comment-reply-link' + suffix) : document.getElementById('add-comment-trigger');
            const addForm = document.getElementById('add-comment-form' + suffix);

            const csrf = addForm.dataset.csrf;

            const nameError = document.getElementById('name-error' + suffix);
            const commentError = document.getElementById('comment-error' + suffix);
            const imageError = document.getElementById('image-error' + suffix);
            const nameInput = document.getElementById('comment-username' + suffix);
            const ancestorId = replyToComment ? document.getElementById('ancestor-id' + suffix).value : undefined;
            const depth = document.getElementById('depth' + suffix).value;
            const emailInput = document.getElementById('comment-email' + suffix);
            const commentEditor = document.getElementById('comment-editor' + suffix);
            const submitButton = document.getElementById('submit-comment' + suffix);
            const cancelButton = document.getElementById('cancel-comment-addition' + suffix);
            const commentList = document.getElementById('comment-list');
            const commentXhrErrorContainer = document.getElementById('comment-xhr-error-container' + suffix);
            const commentXhrErrorMessage = document.getElementById('comment-xhr-error-message' + suffix);
            const editControls = document.getElementById('edit-controls' + suffix);

            nameInput.value = nameInput.value || localStorage.getItem('name');
            emailInput.value = emailInput.value || localStorage.getItem('email');

            const initialState = {
                form: {display: 'none'},
                trigger: {display: 'block'},
                name: {value: '', error: false},
                email: {value: ''},
                comment: {value: '', display: 'block', disabled: false, error: 'none', height: '200px'},
                image: {error: 'none'},
                submitButton: {disabled: false},
                commentXhrErrorContainer: {display: 'none'},
                commentXhrErrorMessage: {innerText: ''},
            };

            const reducer = combineReducers([
                rootReducer,
                commentReducer,
                submitReducer,
                addCommentReducer,
                addCommentErrorReducer,
                errorReducer
            ]);

            const listener = function (state) {
                trigger.style.display = state.trigger.display;
                addForm.style.display = state.form.display;

                nameError.style.display = state.name.error;
                imageError.style.display = state.image.error;

                commentEditor.disabled = state.comment.disabled;
                commentEditor.value = state.comment.value
                commentError.style.display = state.comment.error;

                submitButton.disabled = state.submitButton.disabled
                submitButton.hidden = state.submitButton.hidden

                commentXhrErrorContainer.style.display = state.commentXhrErrorContainer.display;
                commentXhrErrorMessage.innerText = state.commentXhrErrorMessage.innerText;

                if (editControls) {
                    editControls.style.display = state.editControls.display;
                }

                if (state.comment.height) {
                    commentEditor.style.height = 'auto';
                    commentEditor.style.height = state.comment.height
                }
            };

            const store = createStore(reducer, initialState, listener);

            addSubmitListener(submitButton, 'submit');

            if (openEditor) {
                store.dispatch({type: 'root', showEditor: true});
                trimEmptyCommentBody(commentEditor);
                commentEditor.focus();
            }

            function rootReducer(state, action) {
                if (action.type === 'root') {

                    const result = {};
                    if (action.showEditor === true) {
                        result.form = assign(state.form, {display: 'block'});
                        result.trigger = assign(state.trigger, {display: 'none'});
                        result.comment = assign(state.comment, {value: ''})
                        result.submitButton = assign(state.submitButton, {disabled: false, hidden: false})
                        result.nameInput = assign(state.nameInput, {disabled: false})
                        result.emailInput = assign(state.emailInput, {disabled: false})
                        createEditorInstance('comment-editor', 'top', suffix);
                        if (replyToComment) {
                            result.editControls = assign(state.editControls, {display: 'none'});
                        }
                    } else if (action.showEditor === false) {
                        result.form = assign(state.form, {display: 'none'});
                        result.trigger = assign(state.trigger, {display: 'inline'});
                        result.comment = assign(state.comment, {value: ''})
                        CKEDITOR.instances['comment-editor' + suffix]?.destroy();
                        commentEditor.innerHTML = '';
                        if (replyToComment) {
                            result.editControls = assign(state.editControls, {display: 'inline'});
                        }
                    }
                    // clear errors
                    result.commentXhrErrorContainer = assign(state.commentXhrErrorContainer, {display: 'none'});

                    state = assign(state, result);
                }
                return state;
            }

            function commentReducer(state, action) {
                if (action.type === 'comment') {
                    const result = {};
                    result.comment = assign(state.comment, {
                        value: action.input.value,
                        height: action.input.height
                    });
                    state = assign(state, result);
                }
                return state;
            }

            function submitReducer(state, action) {
                if (action.type === 'submit') {
                    const result = {};
                    result.submitButton = assign(state.submitButton, {disabled: true});
                    state = assign(state, result);

                    // clear errors
                    store.dispatch({
                        type: 'comment-error'
                    });

                    let url = '/comment?__csrf=' + csrf;
                    if (!!ancestorId) {
                        url += '&a=' + ancestorId + '&d=' + depth;
                    }

                    req({
                        url: url,
                        contentType: 'application/json',
                        method: 'POST',
                        data: JSON.stringify({
                            comment: action.comment,
                            name: action.name,
                            email: action.email,
                            type: 'FOOTER'
                        }),
                        onSuccess: function (xhr) {
                            store.dispatch({
                                type: 'add-comment',
                                comment: xhr.response
                            });
                        },
                        onError: function (xhr) {
                            const contentType = (xhr.getResponseHeader('Content-Type') || '').toLowerCase();
                            let errorMessage = 'Unknown error occurred';
                            if (contentType.startsWith('application/json')) {
                                errorMessage = JSON.parse(xhr.response).message || errorMessage;
                            }
                            store.dispatch({
                                type: 'comment-error',
                                message: errorMessage
                            });
                        }
                    })
                }
                return state;
            }

            function addCommentReducer(state, action) {
                if (action.type === 'add-comment') {
                    const commentBody = action.comment.trim();
                    if (commentBody.includes("data:image/png;base64")) {
                        location.reload();
                        return state;
                    }

                    const result = {};
                    result.submitButton = assign(state.submitButton, {disabled: false});
                    state = assign(state, result);

                    const temp = document.createElement('div')
                    temp.innerHTML = commentBody;
                    const nodes = temp.childNodes;
                    document.querySelectorAll('.comment-element.new-comment').forEach(newComment => {
                        newComment.classList.remove('new-comment');
                    });
                    nodes.forEach(value => {
                        if (value.style) {
                            value.classList.add('new-comment');
                            value.setAttribute('data-parent-id', suffix.substring(1))
                            const parentId = suffix.substring(1);
                            if (parentId !== "0" && document.getElementById('comment-' + parentId)) {
                                const parentComment = document.getElementById('comment-' + parentId);
                                const parentMarginLeft = parseInt(window.getComputedStyle(parentComment).marginLeft, 10);
                                const newMarginLeft = parentMarginLeft + 40;
                                value.style.marginLeft = newMarginLeft + 'px';
                            }
                        }
                        commentList.prepend(value);
                    })
                    // Clear text box
                    commentEditor.value = '';
                    // Hide view
                    store.dispatch({type: 'root', showEditor: false});
                    sortTabs();
                }
                return state;
            }

            function addCommentErrorReducer(state, action) {
                if (action.type === 'comment-error') {
                    const result = {};
                    const displayError = !!action.message;
                    result.commentXhrErrorContainer = assign(state.commentXhrErrorContainer, {display: displayError ? 'flex' : 'none'});
                    result.commentXhrErrorMessage = assign(action.commentXhrErrorMessage, {innerText: action.message || ''});
                    state = assign(state, result);
                }
                return state;
            }

            function errorReducer(state, action) {
                if (action.type === 'error') {
                    const errors = action.errors || {};
                    const result = {};
                    result.name = assign(state.name, {error: errors['name'] ? 'block' : 'none'});
                    result.comment = assign(state.comment, {error: errors['comment'] ? 'block' : 'none'});
                    result.image = assign(state.image, {error: errors['image'] ? 'block' : 'none'});
                    state = assign(state, result);
                }
                return state;
            }

            addEventListener({
                el: trigger,
                name: 'click',
                preventDefault: true,
                listener: function (e) {
                    store.dispatch({type: 'root', showEditor: true});
                    trimEmptyCommentBody(commentEditor);
                    commentEditor.focus();
                }
            });

            addEventListener({
                el: cancelButton,
                name: 'click',
                preventDefault: true,
                listener: function (e) {
                    store.dispatch({type: 'root', showEditor: false});
                }
            });

            addEventListener({
                el: commentEditor,
                name: 'input',
                listener: function (e) {
                    const value = commentEditor.value;
                    const scrollHeight = commentEditor.scrollHeight + 'px';
                    store.dispatch({type: 'comment', input: {value: value, height: scrollHeight}});
                }
            });

            function addSubmitListener(el, type) {
                addEventListener({
                    el: el,
                    name: 'click',
                    preventDefault: true,
                    listener: function (e) {
                        const commentValue =  CKEDITOR.instances['comment-editor' + suffix].getData().trim();

                        const nameValue = nameInput.value.trim();
                        const email = emailInput.value.trim();

                        const escapedNameValue = escapeHtml(nameValue);
                        const escapedEmail = escapeHtml(email);

                        const errors = {
                            image: imageIsLoading(commentValue),
                            comment: isBlank(commentValue),
                            name: isBlank(nameValue)
                        };

                        store.dispatch({
                            type: 'error',
                            errors: errors
                        });

                        if (hasErrors(errors)) {
                            return;
                        }

                        // clear errors
                        store.dispatch({
                            type: 'error'
                        });

                        let finalHtml = '<strong>Added by: ' + escapedNameValue + '</strong>';

                        if (email) {
                            finalHtml += ' <a href="mailto:' + escapedEmail + '">' + escapedEmail + '</a>';
                        }
                        finalHtml += '\n\n' + commentValue;

                        localStorage.setItem('name', nameValue);
                        localStorage.setItem('email', email);

                        store.dispatch({
                            type: type,
                            comment: finalHtml,
                            name: nameValue,
                            email: email,
                        });
                    }
                })
            }

            function req(opts) {
                const xhr = new XMLHttpRequest();
                const base = window.origin + window.location.pathname;
                xhr.open(opts.method, base + opts.url);

                xhr.onerror = function () {
                    opts.onError(xhr);
                };
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4) {
                        const status = xhr.status;
                        if (status === 200) {
                            opts.onSuccess(xhr);
                        } else {
                            opts.onError(xhr);
                        }
                    }
                };

                xhr.setRequestHeader('Content-Type', opts.contentType);
                if (opts.data) {
                    xhr.send(opts.data);
                } else {
                    xhr.send();
                }
            }

            function addEventListener(opts) {
                const preventDefault = opts.preventDefault || false;
                opts.el.addEventListener(opts.name, function (e) {
                    if (preventDefault) {
                        e.preventDefault();
                    }
                    return opts.listener(e);
                })
            }

            function assign(obj, newVal) {
                return Object.assign({}, obj, newVal);
            }

            function isBlank(str) {
                return (!str || /^\s*$/.test(str));
            }

            function imageIsLoading(commentBody) {
                const temp = document.createElement('div')
                temp.innerHTML = commentBody.trim()
                const imgTags = temp.getElementsByTagName('img');
                for (let i = 0; i < imgTags.length; i++) {
                    const src = imgTags[i].getAttribute('src');
                    if (src === '' || src.includes('blob:http')) {
                        return true;
                    }
                }
                return false;
            }

            function hasErrors(obj) {
                for (const key in obj) {
                    if (!obj.hasOwnProperty(key)) {
                        continue;
                    }
                    if (obj[key]) {
                        return true;
                    }
                }
                return false;
            }

            function combineReducers(reducers) {
                return function (firstState, action) {
                    let state = firstState;
                    for (let i = 0; i < reducers.length; i++) {
                        const reducer = reducers[i];
                        state = reducer(state, action);
                    }
                    return state;
                }
            }

            function createStore(reducer, initialState, listener) {
                let state = initialState;
                const queue = [];
                return {
                    dispatch: function (action) {
                        queue.push(function () {
                            state = reducer(state, action);

                            // remove self
                            queue.splice(0, 1);

                            // run next dispatch
                            if (queue.length > 0) {
                                queue[0]();
                            } else {
                                // or finalize and run
                                // listener to submit changes
                                listener(state);
                            }
                        });

                        // If there is more than one
                        // task then it will be executed
                        // at the end of dispatch. No need
                        // to run it here
                        if (queue.length === 1) {
                            queue[0]();
                        }
                    }
                }
            }
        }

        function replyComment(commentId, el) {
            const allowedCommentMeta = document
                .getElementsByTagName('meta')
                .namedItem('allowed-reply-comment-id');

            if (!!allowedCommentMeta) {
                const comments = allowedCommentMeta.getAttribute('content').split(',');
                if (comments.indexOf(commentId + "") === -1) {
                    addComment('-' + commentId, true);
                    allowedCommentMeta.setAttribute('content', allowedCommentMeta.getAttribute('content') + ',' + commentId);

                    document.getElementById('comment-' + commentId).parentElement.style.background = '';
                }
            }
            setupEmailValidation('-' + commentId);
        }

        function trimEmptyCommentBody(comment) {
            if (!!comment && !!comment.value && comment.value.trim().length === 0) {
                comment.value = '';
            }
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/'/g, "&#039;");
        }

        (function () {
            addComment('');

            const allowedCommentMeta = document
                .getElementsByTagName('meta')
                .namedItem('allowed-reply-comment-id');

            if (!!allowedCommentMeta) {
                const comments = allowedCommentMeta.getAttribute('content').split(',');

                for (let i = 0; i < comments.length; i++) {
                    addComment('-' + comments[i]);
                }
            }
        })()
    </script>
</div>
</div>
<div id="inline-comments-outlet">
<div>
<style>
            html {
                --ds-background-accent-yellow-subtle: #f5cd47;
                --ds-background-accent-yellow-subtler: #f8e6a0;
                --ds-background-neutral-subtle: #0000;
                --ds-background-neutral-subtle-hovered: #091e420f;
                --ds-background-neutral-subtle-pressed: #091e4224;
                --ds-border: #091e4224;
                --ds-border-accent-yellow: #b38600;
                --ds-surface-overlay: #FFFFFF;
                --ds-shadow-overlay: 0px 8px 12px #091e4226,0px 0px 1px #091e424f;
                --ds-text: #172b4d;
                --ds-text-subtlest: #626f86;
            }

            #inline-comment-sidebar {
                z-index: 11;
                box-shadow: rgba(9, 30, 66, 0.25) 0 8px 16px -4px;
                background-color: rgb(255, 255, 255);
                right: 12px;
                position: absolute;
                display: none;
                flex-direction: column;
                box-sizing: border-box;
                margin-bottom: 100px;
                width: 280px;
                border-width: 1px;
                border-style: solid;
                border-color: rgb(223, 225, 230);
                border-image: initial;
                border-radius: 3px;
                left: 100vw;
            }

            .inline-comment {
                display: none;
                flex-direction: column;
                position: initial;
                cursor: auto;
                border-left: 0;
                border-top: 0;
                animation: 0.5s linear 0s 1 normal forwards running none;
            }

            .inline-comment-element {
                display: flex;
                flex-direction: column;
                border-bottom: 1px solid rgb(223, 225, 230);
                padding: 12px 16px 0 16px;
            }

            .inline-comment-sidebar-header {
                position: relative;
                display: flex;
                justify-content: space-between;
                height: 35px;
                padding: 10px 12px 0;
                background-color: rgb(255, 255, 255);
                color: rgb(137, 147, 164);
            }

            .inline-comment-navigation {
                display: flex;
            }

            .inline-comment-button {
                -webkit-box-align: baseline;
                align-items: baseline;
                box-sizing: border-box;
                display: inline-flex;
                font-size: inherit;
                font-style: normal;
                font-family: inherit;
                font-weight: 500;
                max-width: 100%;
                position: relative;
                text-align: center;
                white-space: nowrap;
                cursor: pointer;
                vertical-align: middle;
                -webkit-box-pack: center;
                justify-content: center;
                width: 26px;
                height: 26px;
                border-width: 0;
                text-decoration: none;
                transition: background 0.1s ease-out 0s, box-shadow 0.15s cubic-bezier(0.47, 0.03, 0.49, 1.38) 0s;
                padding: 0 2px;
                background: none;
                border-radius: 4px;
                text-rendering: auto;
                letter-spacing: normal;
                word-spacing: normal;
                text-transform: none;
                text-indent: 0;
                text-shadow: none;
                margin: 0;
                border-style: outset;
                border-color: buttonface;
                border-image: initial;
                line-height: 24px;
            }

            .inline-comment-button:not([disabled]):hover {
                background: rgba(9, 30, 66, 0.08);
                border: none;
            }

            .inline-comment-button:not([disabled]):focus {
                outline: 0 !important;
            }

            .inline-comment-button span {
                height: 24px;
                width: 24px;
            }

            .inline-comment-button.resolved .button-icon {
                color: rgb(54, 179, 126);
                cursor: default;
            }

            .inline-comment-button.resolved:hover {
                background: rgb(255, 255, 255);
            }

            .inline-comment-marker.visible {
                background-color: var(--ds-background-accent-yellow-subtler, #FFF0B3);
                border-bottom: 2px solid var(--ds-border-accent-yellow, rgba(255, 196, 0, 0.82));
            }

            .inline-comment-marker.highlited {
                background-color: var(--ds-background-accent-yellow-subtle, #FFE380);
                border-bottom: 2px solid var(--ds-border-accent-yellow, #FFAB00);
                box-shadow: var(--ds-shadow-overlay, 0 2px 2px #C1C7D0);
            }

            .button-icon-container {
                opacity: 1;
                align-self: center;
                display: flex;
                -webkit-box-flex: 0;
                flex-grow: 0;
                flex-shrink: 0;
                line-height: 0;
                font-size: 0;
                user-select: none;
                transition: opacity 0.3s ease 0s;
                margin: 0 2px;
            }

            .button-icon {
                color: rgb(137, 147, 164);
                display: inline-block;
                fill: rgb(255, 255, 255);
                flex-shrink: 0;
                line-height: 1;
            }

            .inline-comments-nav {
                padding-left: 10px;
                vertical-align: text-top;
                line-height: 24px;
            }

            .inline-comment .element {
                display: flex;
            }

            .inline-comment-icon-container {
                padding-right: 8px;
            }

            .inline-comment .inline-comment-icon {
                height: 32px;
                width: 32px;
                -webkit-box-align: stretch;
                align-items: stretch;
                background-color: rgb(255, 255, 255);
                box-sizing: content-box;
                cursor: inherit;
                display: flex;
                flex-direction: column;
                -webkit-box-pack: center;
                justify-content: center;
                position: static;
                transform: translateZ(0px);
                box-shadow: rgb(255, 255, 255) 0 0 0 2px;
                font-size: inherit;
                font-family: inherit;
                border-radius: 50%;
                outline: none;
                overflow: hidden;
                transition: transform 200ms ease 0s, opacity 200ms ease 0s;
                border-width: initial;
                border-style: none;
                border-color: initial;
                border-image: initial;
                margin: 2px;
            }

            .inline-comment .icon-el {
                background-size: cover;
                display: block;
                height: 100%;
            }

            .inline-comment .comment-info {
                display: flex;
                flex-direction: column;
            }

            .inline-comment .title-date {
                font-size: 11px;
                line-height: 16px;
                color: rgb(107, 119, 140);
            }

            .inline-comment .comment-description {
                padding: 10px 4px;
                border-radius: 3px;
            }

            .showed {
                left: calc(100vw - 300px) !important;
            }

            .inline-comment-new-reply-container {
                padding: 12px 16px;
            }

            #inline-comment-reply-trigger {
                height: 30px;
                padding: 4px;
                width: 100%;
                border: 1px solid #dfe1e6;
                border-radius: 3px;
                box-sizing: border-box;
            }

            .add-inline-comment-form {
                flex-direction: column;
            }

            #inline-comment-editor {
                min-height: 150px;
                overflow-y: hidden;
                max-width: 246px;
            }

            .flex-row-reverse {
                display: flex;
                flex-direction: row-reverse;
                gap: 5px;
            }

            .resolved-container {
                position: absolute;
                left: 140px;
                top: 10px;
            }

            .highlight-actions-popup-buttons {
                display: flex;
            }

            .highlight-actions-popup-buttons > button {
                display: flex;
                font-family: inherit;
                font-weight: 500;
                color: var(--ds-text, #42526E) !important;
                margin: 2px 8px;
                padding: 0 10px;
                height: inherit;
                line-height: normal;
                align-items: center;
                border-width: 0;
                border-radius: 3px;
                background-color: var(--ds-background-neutral-subtle);
                transition: background 0.1s ease-out 0s, box-shadow 0.15s cubic-bezier(0.47, 0.03, 0.49, 1.38) 0s;
            }

            .highlight-actions-popup-buttons > button:hover {
                background-color: var(--ds-background-neutral-subtle-hovered, #FFFFFF);
            }

            .highlight-actions-popup-buttons > button:active {
                background-color: var(--ds-background-neutral-subtle-pressed, #FFFFFF);
            }

            .highlight-actions-popup-buttons > button > span {
                display: flex;
                margin: 0 2px;
            }

            .highlight-actions-popup-container {
                position: absolute;
                transition: top 100ms ease-out 0s, left 100ms ease-out 0s;
                animation: 100ms linear 0s 1 normal forwards running popup;
            }

            .highlight-actions-popup {
                transform: translate(calc(-50% - 5px), calc(-100% - 20px));
                box-shadow: var(--ds-shadow-overlay, 0px 3px 5px rgba(9, 30, 66, 0.2), 0px 0px 1px rgba(9, 30, 66, 0.31));
                border-radius: 3px;
                position: absolute;
                background-color: var(--ds-surface-overlay, #fff);
                display: none;
                opacity: 0;
                transition: opacity 0.1s linear 0s;
            }

            .highlight-actions-popup-buttons {
                padding: var(--ds-space-025, 2px);
                display: flex;
                border-right: 1px solid var(--ds-border, #EBECF0);
            }

            .highlight-actions-popup-buttons > button, .highlight-actions-popup-buttons > button:hover {
                margin: var(--ds-space-025, 2px) var(--ds-space-100, 8px);
                height: inherit;
                line-height: normal;
                display: flex;
                -webkit-box-align: center;
                align-items: center;
            }

            #inline-comment-teaser-popup {
                z-index: 400;
                position: absolute;
                top: 40px;
            }

            .inline-comment-teaser-popup-container {
                display: block;
                box-sizing: border-box;
                z-index: 400;
                flex: 1 1 auto;
                background-color: var(--ds-surface-overlay, #FFFFFF);
                border-radius: var(--ds-border-radius, 3px);
                box-shadow: var(--ds-shadow-overlay, 0 4px 8px -2px rgba(9, 30, 66, 0.25), 0 0 1px rgba(9, 30, 66, 0.31));
                --ds-elevation-surface-current: var(--ds-surface-overlay, #FFFFFF);
                overflow: auto;
            }

            .inline-comment-teaser-popup-inner {
                flex-direction: column;
                justify-content: center;
                display: flex;
                align-items: center;
                width: 241px;
                height: 214px;
                margin: var(--ds-space-200, 20px) var(--ds-space-300, 24px);
            }

            .inline-comment-teaser-popup-inner h1 {
                margin-top: 0;
                font-weight: 500;
                font-size: 20px;
                margin-bottom: var(--ds-space-150, 9pt);
                var(--ds-text, #333);
                line-height: 1.25;
                letter-spacing: -0.01em;
                text-transform: none;
            }

            .inline-comment-teaser-popup-inner img {
                max-width: 100%;
            }

            @media (prefers-color-scheme: dark) {
                html:not(.light-mode) {
                    --ds-background-accent-yellow-subtle: #7F5F01;
                    --ds-background-accent-yellow-subtler: #533F04;
                    --ds-background-neutral-subtle: #00000000;
                    --ds-background-neutral-subtle-hovered: #A1BDD914;
                    --ds-background-neutral-subtle-pressed: #A6C5E229;
                    --ds-border: #A6C5E229;
                    --ds-border-accent-yellow: #CF9F02;
                    --ds-surface-overlay: #282E33;
                    --ds-shadow-overlay: 0px 0px 0px 1px #39424a, 0px 8px 12px #0304045C, 0px 0px 1px 1px #03040480;
                    --ds-text: #B6C2CF;
                    --ds-text-subtlest: #8C9BAB;
                }

                #inline-comment-sidebar {
                    box-shadow: rgba(4, 4, 4, 0.25) 0 8px 16px -4px;
                    background-color: rgb(38, 38, 38);
                    border-color: rgb(51, 51, 51);
                }

                .inline-comment-sidebar-header {
                    background-color: rgb(38, 38, 38);
                    color: rgb(205, 206, 206);
                }

                .inline-comment-element {
                    border-bottom: 1px solid rgb(51, 51, 51);
                }

                .inline-comment .title-date {
                    color: rgb(165, 183, 215);
                }

                #inline-comment-reply-trigger {
                    border: 1px solid #717173;
                }
            }

        </style>
<div id="inline-comment-sidebar">
<div class="inline-comment-sidebar-header">
<div class="inline-comment-navigation" id="inline-comment-navigation">
<div>
<button class="inline-comment-button" disabled="" id="show-previous-button" type="button">
<span class="button-icon-container">
<span class="button-icon" role="img">

</span>
</span>
</button>
</div>
<div>
<button class="inline-comment-button" disabled="" id="show-next-button" type="button">
<span class="button-icon-container">
<span class="button-icon" role="img">

</span>
</span>
</button>
</div>
<span class="inline-comments-nav">
<span id="current-inline-comment">1</span> of <span id="all-inline-comments">0</span>
</span>
</div>
<div></div> <!-- allows close button to stay on the right when navigation is hidden -->
<div>
<button class="inline-comment-button" id="hide-inline-comment-button" type="button">
<span class="button-icon-container">
<span aria-label-right="Close comment sidebar" class="button-icon" role="img">

</span>
</span>
</button>
</div>
</div>
<div id="inline-comment-list">
</div>
<template id="inline-comment-teaser-template">
<div id="inline-comment-teaser-popup">
<div class="inline-comment-teaser-popup-container">
<div class="inline-comment-teaser-popup-inner" data-cy="inline-comment-gif">
<div><h1>Be the first to add an inline comment</h1></div>
<picture>
<source media="(prefers-color-scheme: dark)" srcset="/static/img/gif/inline-comment-teaser-dark.gif"/>
<img src="/docs/images\inline-comment-teaser.gif"/>
</picture>
<p>Share your feedback or ask a question by highlighting text and clicking <b>Comment</b>.</p>
</div>
</div>
</div>
</template>
<div class="inline-comment-new-reply-container" id="inline-comment-new-reply-container">
<input class="confluence-input" id="inline-comment-reply-trigger" placeholder="Reply"/>
<form class="add-inline-comment-form" data-csrf="d8af1ee5-6a3c-4950-8781-90094795f2cf.7Hrh3_xXsozwqe2N4h3V0QZVDoDPve8anM13azPmdss" id="add-inline-comment-form" style="display:none;">
<input class="flex-grow-1 confluence-input" id="inline-comment-username" name="username" placeholder="Name" value=""/>
<div class="flex-row margin-top-5 color-error" id="inline-comment-name-error" style="display: none; align-items: center; gap: 5px;">
<span style="display: inline-block; width: 16px; height: 16px">

</span>
                            Name is required
                        </div>
<input class="flex-grow-1 confluence-input margin-top-5" id="inline-comment-email" name="email" placeholder="Email" value=""/>
<div class="flex-row margin-top-5 color-error" id="inline-comment-email-error" style="display: none; align-items: center; gap: 5px;">
<span style="display: inline-block; width: 16px; height: 16px">

</span>
                            Email format invalid
                        </div>
<div class="confluence-input margin-top-5" contenteditable="true" id="inline-comment-editor" placeholder="Comment">
<p><br/></p>
</div>
<div class="flex-row margin-top-5 color-error" id="inline-comment-error" style="display: none; align-items: center; gap: 5px;">
<span style="display: inline-block; width: 16px; height: 16px">

</span>
                            Comment is required
                        </div>
<div class="flex-row-reverse align-items-baseline margin-top-10">
<button class="button subtle" id="cancel-inline-comment-addition" type="button">Cancel
                            </button>
<button class="button primary" id="submit-inline-comment" type="button">Save
                            </button>
</div>
</form>
<div class="flex-row margin-top-10" id="inline-comment-xhr-error-container" style="display: none; padding: 10px 16px; border-radius: 3px; background-color: var(--ds-background-danger, #FFEBE6)">
<div class="color-error">
<span style="display: inline-block; width: 24px; height: 24px">

</span>
</div>
<span id="inline-comment-xhr-error-message" style="padding: 0 10px">Unknown error occurred</span>
</div>
</div>
</div>
<div id="highlight-actions-portal-container">
<div class="highlight-actions-popup-container">
<div class="highlight-actions-popup">
<div class="highlight-actions-popup-buttons">
<button id="new-comment-button">
<span aria-hidden="true"> 
</span><span>Comment</span>
</button>
</div>
</div>
</div>
</div>
<script>
            (function () {
                // emailRegExp from https://html.spec.whatwg.org/multipage/input.html#valid-e-mail-address
                const emailRegExp = /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
                const uuid = getUuid();
                let currentlyDisplayed;
                let currentlyDisplayedEl;
                let loadInProgress = false;
                let clickData;

                const contentContainer = document.querySelector("div.main-panel.wiki-content .description");
                const contentWrapper = document.getElementsByClassName("content-wrapper").item(0);
                let contentContainerHeight = contentContainer.offsetHeight;

                const sidebar = document.getElementById('inline-comment-sidebar');
                const navigation = document.getElementById('inline-comment-navigation');
                const inlineCommentList = document.getElementById('inline-comment-list');
                let sideBarTop = 0;
                let sideBarBottom = 0;
                const currentInlineComment = document.getElementById('current-inline-comment');
                const allInlineCommentsCount = document.getElementById('all-inline-comments');
                const hideInlineCommentButton = document.getElementById('hide-inline-comment-button');
                const cancelInlineCommentAddition = document.getElementById('cancel-inline-comment-addition');

                const showPreviousButton = document.getElementById('show-previous-button');
                const showNextButton = document.getElementById('show-next-button');

                const inlineCommentFormContainer = document.getElementById('inline-comment-new-reply-container');
                const replyTrigger = document.getElementById('inline-comment-reply-trigger');
                const inlineCommentForm = document.getElementById('add-inline-comment-form');
                const inlineCommentFormError = document.getElementById('inline-comment-xhr-error-container');
                const inlineCommentFormErrorMessage = document.getElementById('inline-comment-xhr-error-message');
                const csrf = inlineCommentForm ? inlineCommentForm.dataset.csrf : '';

                const nameInput = document.getElementById('inline-comment-username');
                const emailInput = document.getElementById('inline-comment-email');
                const commentInput = document.getElementById('inline-comment-editor');

                const nameError = document.getElementById('inline-comment-name-error');
                const emailError = document.getElementById('inline-comment-email-error');
                const commentError = document.getElementById('inline-comment-error');

                const submitButton = document.getElementById('submit-inline-comment');

                if (!!hideInlineCommentButton) {
                    hideInlineCommentButton.onclick = () => {
                        hideInlineComments();
                    };
                }
                if (!!cancelInlineCommentAddition) {
                    cancelInlineCommentAddition.onclick = () => {
                        hideReplyForm();
                    };
                }
                if (!!replyTrigger) {
                    replyTrigger.onclick = () => {
                        showReplyForm();
                    };
                }
                if (!!submitButton) {
                    submitButton.onclick = () => {
                        submitComment();
                    };
                }

                let inlineCommentsData = [];

                let number = 1;

                const parser = new URL(window.location);
                if (parser.searchParams.has('openInlineCommentId')) {
                    parser.searchParams.delete('openInlineCommentId');
                    window.history.replaceState({}, document.title, parser.href);
                }

                document.querySelectorAll('span.inline-comment-marker').forEach(el => {
                    const markerRef = el.getAttribute('data-ref');
                    const existing = inlineCommentsData.find(data => data.markerRef === markerRef);

                    if (existing) {
                        existing.markerElements.push(el);
                    } else {
                        inlineCommentsData.push({
                            markerElements: [el],
                            markerRef: markerRef,
                            number: number++,
                            visible: false
                        });
                    }
                });

                    commentInput.addEventListener('input', () => {
                        commentInput.style.height = 'auto';
                        commentInput.style.height = (commentInput.scrollHeight + 5) + 'px';
                        if (commentInput.innerHTML === '') {
                            commentInput.innerHTML = '<p><br></p>';
                            commentInput.firstElementChild.focus();
                        }
                    });

                    commentInput.addEventListener('focus', () => {
                        if (!commentInput.firstChild) {
                            commentInput.innerHTML = '<p><br></p>'
                        }
                        commentInput.firstElementChild.focus();
                    });

                let index;
                let activeCommentsCount = 0;
                allInlineCommentsCount.innerHTML = activeCommentsCount;

                if (activeCommentsCount > 1) {
                    showPreviousButton.onclick = () => {
                        showNext();
                    };
                    showNextButton.onclick = () => {
                        showPrevious();
                    };
                } else {
                    showPreviousButton.disabled = true;
                    showNextButton.disabled = true;

                    showPreviousButton.querySelector('.button-icon').removeAttribute('aria-label-top');
                    showNextButton.querySelector('.button-icon').removeAttribute('aria-label-top');
                }

                initializeClickData();

                inlineCommentsData.forEach(data => {
                    data.markerElements.forEach(el => {
                        el.onclick = (event) => {
                            if (!loadInProgress) {
                                clickData.el = el;
                                clickData.data = data;
                                clickData.inlineCommentProperties = undefined;
                                if (!currentlyDisplayed || currentlyDisplayed.id !== data.id) {
                                    clickData.showNew = true;
                                } else if (currentlyDisplayed.visible) {
                                    clickData.hideAll = true;
                                }
                                clickData.actionRequired = true;
                                setTimeout(() => markerElementClickHandler(), 100);
                                if (!!inlineCommentFormContainer) {
                                    inlineCommentFormContainer.style.display = clickData.data.resolved ? 'none' : 'block';
                                }
                            }
                            event.preventDefault();
                            event.stopPropagation();
                        };
                    });
                });

                    const newCommentButton = document.getElementById('new-comment-button');
                    newCommentButton.addEventListener('click', () => {
                        if (loadInProgress) {
                            return;
                        }
                        clickData.el = window.getSelection().getRangeAt(0);
                        clickData.data = null;
                        if (!currentlyDisplayed) {
                            clickData.showNew = true;
                        } else if (currentlyDisplayed.visible) {
                            clickData.hideAll = true;
                        }
                        clickData.actionRequired = true;
                        clickData.inlineCommentProperties = calculateNewInitialCommentData();
                        setTimeout(() => {
                            markerElementClickHandler();
                            hideHighlightActions();
                        });

                        function calculateNewInitialCommentData() {
                            const selection = window.getSelection();
                            const textSelection = selection.toString().replaceAll('\n', '');
                            const selectionStartNode = selection.getRangeAt(0).startContainer;
                            const selectionStartOffset = selection.getRangeAt(0).startOffset;
                            const contentWrapper = /** @type {HTMLDivElement} */ document.getElementsByClassName('content-wrapper')[0];
                            const textSelectionMatchCount = countOccurrences(contentWrapper.innerText.replaceAll('\n', ''), textSelection);

                            // insert tracker to find selectionStartNode in innerText
                            const tracker = createTracker();
                            selectionStartNode.parentElement.insertBefore(tracker, selectionStartNode);
                            const innerTextWithTracker = contentWrapper.innerText.replaceAll('\n', '');
                            tracker.remove();

                            const afterTrackerIndex = innerTextWithTracker.indexOf(tracker.innerText) + tracker.innerText.length + selectionStartOffset;
                            const tail = innerTextWithTracker.slice(afterTrackerIndex);
                            const selectedTextInTailCount = countOccurrences(tail, textSelection);
                            const textSelectionMatchIndex = textSelectionMatchCount - selectedTextInTailCount;

                            return {textSelection, textSelectionMatchCount, textSelectionMatchIndex}

                            // Function to find occurrences of a substring in a string and return their indexes
                            function countOccurrences(str, sub) {
                                let count = 0;
                                if (str && sub) {
                                    let index = str.indexOf(sub, 0);
                                    while (index !== -1) {
                                        count++;
                                        index = str.indexOf(sub, index + 1);
                                    }
                                }
                                return count;
                            }

                            // creates easily trackable element
                            function createTracker() {
                                const tracker = document.createElement('i');
                                tracker.style = 'position: absolute; opacity: 0';
                                tracker.innerText = '[' + crypto.randomUUID() + ']';
                                return tracker;
                            }
                        }
                    });

                    let selectionStartNode;

                    contentWrapper.addEventListener('mousedown', () => {
                        selectionStartNode = null;
                    });

                    contentWrapper.addEventListener('mouseup', () => {
                        setTimeout(() => {
                            if (window.getSelection().toString().length === 0) {
                                hideHighlightActions();
                                return;
                            }
                            showHighlightActions();
                        })
                    });

                    function hideHighlightActions() {
                        document.getElementsByClassName('highlight-actions-popup').item(0).style['opacity'] = '0';
                        document.getElementsByClassName('highlight-actions-popup').item(0).style['display'] = 'none';
                    }

                    function showHighlightActions() {
                        const sel = window.getSelection();
                        const actionsContainer = document.getElementById('highlight-actions-portal-container');
                        const actionsContainerRect = actionsContainer.getClientRects().item(0);
                        const selRects = sel.getRangeAt(0).getClientRects();
                        const selRect = selRects.item(0);
                        let rectIndex = 1;
                        while (rectIndex < selRects.length && selRects.item(rectIndex).top === selRect.top) {
                            rectIndex++;
                        }
                        const popup = /** @type {HTMLDivElement} */ document.getElementsByClassName('highlight-actions-popup').item(0);
                        popup.setAttribute('style', 'display: flex;');
                        const offset = {
                            x: Math.max(
                                Math.min(
                                    selRect.x - actionsContainerRect.x + (selRects.item(rectIndex - 1).right - selRect.left) / 2,
                                    window.innerWidth - popup.clientWidth / 2 - 20
                                ),
                                popup.clientWidth / 2 + 20
                            ),
                            y: selRect.y - actionsContainerRect.y
                        }
                        popup.setAttribute('style', 'left: ' + offset.x + 'px; top: ' + offset.y + 'px; display: flex; opacity: 1');
                    }

                initInlineCommentButton('inline-comment-show-button');
                initInlineCommentButton('inline-comment-show-button-mobile');

                function initInlineCommentButton(showButtonId) {
                    const inlineCommentShowButton = document.getElementById(showButtonId);
                    if (!inlineCommentShowButton) {
                        return;
                    }

                    if (inlineCommentsData.length > 0) {
                        inlineCommentShowButton.parentElement.style.display = 'flex';
                        inlineCommentShowButton.addEventListener('click', () => {
                            inlineCommentsData[0].markerElements[0].click();
                        });
                    }
                    if (inlineCommentsData.length === 0) {
                        inlineCommentShowButton.parentElement.style.display = 'flex';
                        inlineCommentShowButton.addEventListener('click', () => {
                            showInlineCommentsTeaser(inlineCommentShowButton);
                        })
                    }
                    document.addEventListener('mouseup', (event) => {
                        const teaserPopup = document.getElementById('inline-comment-teaser-popup');
                        if (!isMouseEventInsideElement(event, teaserPopup) && !isMouseEventInsideElement(event, inlineCommentShowButton)) {
                            hideInlineCommentsTeaser();
                        }

                        if (elementContainsSelection(contentWrapper)) {
                            return;
                        }
                        hideHighlightActions();

                        function elementContainsSelection(el) {
                            const sel = window.getSelection();
                            return sel.rangeCount > 0 && [...Array(sel.rangeCount).keys()].every(
                                i => el.contains(sel.getRangeAt(i).commonAncestorContainer)
                            );
                        }
                    })

                    function showInlineCommentsTeaser(inlineCommentShowButton) {
                        if (hideInlineCommentsTeaser()) {
                            return;
                        }
                        const teaserPopup = document.getElementById('inline-comment-teaser-template').content.cloneNode(true);

                        const offset = inlineCommentShowButton.parentElement.parentElement.getBoundingClientRect().right -
                            inlineCommentShowButton.getBoundingClientRect().right;
                        teaserPopup.firstElementChild.style.right = offset + 'px';
                        inlineCommentShowButton.parentElement.parentElement.appendChild(teaserPopup);
                    }
                }

                function hideInlineCommentsTeaser() {
                    const teaserPopup = document.getElementById('inline-comment-teaser-popup');
                    if (teaserPopup) {
                        teaserPopup.remove();
                        return true;
                    }
                    return false;
                }

                function initializeClickData(inlineCommentProperties) {
                    clickData = {
                        actionRequired: false,
                        showNew: false,
                        hideAll: false,
                        data: null,
                        inlineCommentProperties,
                        el: null
                    };
                }

                function markerElementClickHandler() {
                    if (clickData.actionRequired) {
                        if (clickData.inlineCommentProperties?.textSelectionMatchCount) {
                            currentlyDisplayed = null;
                            currentlyDisplayedEl = null;
                            showNewInitialCommentPopup(clickData.el);
                        } else if (clickData.showNew) {
                            clickData.inlineCommentProperties = undefined;
                            showComment(clickData.data, clickData.el);
                        } else if (clickData.hideAll) {
                            hideInlineComments();
                        } else {
                            const top = window.pageYOffset + clickData.el.getBoundingClientRect().top;
                            showSideBar(top, true);
                            highlightCurrentlyDisplayed(currentlyDisplayed);
                            setTimeout(() => {
                                sidebar.classList.add('showed');
                                resizeContentContainer();
                            }, 100);
                        }
                    }
                    initializeClickData(clickData.inlineCommentProperties);
                }

                function loadComments(data, el) {
                    loadInProgress = true;
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', '/content/inline-comments/' + uuid + '/' + data.id);
                    xhr.send();

                    sidebar.style.display = 'none';
                    hideReplyForm();

                    xhr.onload = function () {
                        loadInProgress = false;
                        if (xhr.status !== 200) {
                            return;
                        }
                        showComment(data, el, JSON.parse(xhr.response));
                    };

                    xhr.onerror = function () {
                        handleError(xhr);
                    };
                }

                function showNewInitialCommentPopup(el) {
                    inlineCommentsData.forEach(comment => {
                        comment.visible = false;
                        comment.markerElements.forEach(markerElement => {
                            markerElement.classList.remove('highlited');
                        });
                    });
                    const top = window.pageYOffset + el.getBoundingClientRect().top;
                    showSideBar(top, false);
                    scrollToHalfPageHeight(top);
                    sidebar.classList.add('showed');
                    resizeContentContainer();
                    if (!!inlineCommentFormContainer) {
                        inlineCommentFormContainer.style.display = 'block';
                    }
                    showReplyForm();
                }

                function showComment(data, el, comments) {
                    currentlyDisplayed = data;
                    currentlyDisplayedEl = el;

                    const top = window.pageYOffset + el.getBoundingClientRect().top;
                    showSideBar(top, true);
                    scrollToHalfPageHeight(top);

                    if (!!comments) {
                        addComments(comments, data.id);
                    }

                    sidebar.classList.add('showed');

                    currentInlineComment.innerText = '' + data.number;

                    show(data.element);

                    highlightCurrentlyDisplayed(data);
                    resizeContentContainer();
                }

                function addComments(comments, id) {
                    const container = document.getElementById('main-inline-comments-' + id);
                    container.innerHTML = '';

                    let commentElement;
                    for (let i = 0; i < comments.length; i++) {
                        let comment = comments[i].commentMapped;
                        const author = comment.author;

                        commentElement = document.createElement('div');
                        commentElement.classList.add('inline-comment-element');

                        let element = document.createElement('div');
                        element.classList.add('element');

                        let iconContainer = document.createElement('div');
                        iconContainer.classList.add('inline-comment-icon-container');

                        let icon = document.createElement('div');
                        icon.classList.add('inline-comment-icon');

                        let iconEl = document.createElement('span');
                        iconEl.classList.add('icon-el');
                        icon.appendChild(iconEl);

                        if (author.avatarUrl) {
                            iconEl.style.backgroundImage = 'url(' + author.avatarUrl + ')';
                        }
                        iconContainer.appendChild(icon);

                        element.appendChild(iconContainer);

                        let info = document.createElement('div');
                        info.classList.add('comment-info');

                        if (author.displayName) {
                            info.innerText = author.displayName;
                        }
                        if (comment.created) {
                            let title = document.createElement('span');
                            title.classList.add('title-date');
                            title.innerText = comment.created;
                            info.appendChild(title);
                        }

                        element.appendChild(info);

                        commentElement.appendChild(element);

                        let description = document.createElement('div');
                        description.classList.add('comment-description');
                        description.innerHTML = comment.content;
                        commentElement.appendChild(description);

                        container.appendChild(commentElement);
                    }
                }

                function highlightCurrentlyDisplayed(data) {
                    data.markerElements.forEach(markerElement => {
                        markerElement.classList.add('highlited');
                    });
                    data.visible = true;

                    inlineCommentsData.forEach(comment => {
                        if (comment.id !== data.id) {
                            comment.visible = false;
                            hide(comment.element);
                            comment.markerElements.forEach(markerElement => {
                                markerElement.classList.remove('highlited');
                            });
                        }
                    });
                }

                function showSideBar(top, withExistingComments) {
                    sidebar.style.top = top + 'px';
                    sidebar.style.height = 'auto';
                    sidebar.style.display = 'flex';
                    navigation.style.display = withExistingComments ? 'flex' : 'none';
                    inlineCommentList.style.display = withExistingComments ? 'block' : 'none';
                    if (!!cancelInlineCommentAddition) {
                        cancelInlineCommentAddition.style.display = withExistingComments ? 'block' : 'none';
                    }
                    sideBarTop = top;
                    if (withExistingComments) {
                        hideReplyForm();
                    }
                }

                function resizeContentContainer(additionalHeightToAdd) {
                    const inlineComments = sidebar.querySelectorAll(".inline-comment");
                    inlineComments.forEach(inlineComment => {
                        if (inlineComment.style.display === 'flex') {
                            let height = contentContainerHeight + inlineComment.offsetHeight;
                            if (additionalHeightToAdd) {
                                height += additionalHeightToAdd;
                            }
                            sideBarBottom = sideBarTop + sidebar.offsetHeight;
                            if (sideBarBottom > height) {
                                height += sideBarBottom - height;
                            }
                            contentContainer.style.minHeight = height + 'px';
                        }
                    });
                }

                function hideInlineComments() {
                    sidebar.classList.remove('showed');
                    hideReplyForm();
                    inlineCommentsData.forEach(comment => {
                        comment.visible = false;
                        comment.markerElements.forEach(markerElement => {
                            markerElement.classList.remove('highlited');
                        });
                    });
                    setTimeout(() => {
                        sidebar.style.height = '0';
                        sidebar.style.display = 'none';
                        contentContainer.style.minHeight = contentContainerHeight + 'px';
                    }, 400);
                }

                function showNext() {
                    const current = parseInt(currentInlineComment.innerText);
                    let toShow;
                    if (inlineCommentsData.length > current) {
                        toShow = inlineCommentsData[current];
                    } else {
                        toShow = inlineCommentsData[0];
                    }
                    showComment(toShow, toShow.markerElements[0]);
                    hideReplyForm();
                    if (!!inlineCommentFormContainer) {
                        inlineCommentFormContainer.style.display = toShow.resolved ? 'none' : 'block';
                    }
                }

                function showPrevious() {
                    const current = parseInt(currentInlineComment.innerText);
                    let toShow;
                    if (current > 1) {
                        toShow = inlineCommentsData[current - 2];
                    } else {
                        toShow = inlineCommentsData[inlineCommentsData.length - 1];
                    }
                    showComment(toShow, toShow.markerElements[0]);
                    hideReplyForm();
                    if (!!inlineCommentFormContainer) {
                        inlineCommentFormContainer.style.display = toShow.resolved ? 'none' : 'block';
                    }
                }

                function showReplyForm() {
                    hide(replyTrigger);
                    show(inlineCommentForm);
                    commentInput.innerHTML = '<p><br></p>';
                    resizeContentContainer(275);
                    if (!nameInput.value) {
                        nameInput.focus();
                    } else if (!emailInput.value) {
                        emailInput.focus();
                    } else {
                        commentInput.firstElementChild.focus();
                    }
                }

                function hideReplyForm() {
                    hide(inlineCommentForm);
                    hide(inlineCommentFormError);
                    hide(inlineCommentFormErrorMessage);
                    hide(nameError);
                    hide(emailError);
                    hide(commentError);
                    show(replyTrigger);
                    resizeContentContainer();
                }

                function commentBody() {
                    const nameValue = nameInput.value;
                    const emailValue = emailInput.value;
                    const commentTextValue = commentInput.innerText;
                    const commentHTMLValue = commentInput.innerHTML;

                    let error = false;
                    if (isBlank(nameValue)) {
                        show(nameError);
                        error = true;
                    } else {
                        hide(nameError);
                    }
                    if (!isBlank(emailValue) && !isEmailValid(emailValue)) {
                        show(emailError);
                        error = true;
                    } else {
                        hide(emailError);
                    }
                    if (isBlank(commentTextValue)) {
                        show(commentError);
                        error = true;
                    } else {
                        hide(commentError);
                    }

                    return {
                        finalJson: {
                            comment: commentHTMLValue,
                            parentCommentId: currentlyDisplayed?.id,
                            inlineCommentProperties: clickData.inlineCommentProperties,
                            name: nameValue,
                            email: emailValue,
                            type: 'INLINE'
                        },
                        error: error
                    };
                }

                function submitComment() {
                    const data = commentBody();

                    if (!data.error) {
                        submitButton.disabled = true;
                        req({
                            url: '/inline-comment?__csrf=' + csrf,
                            contentType: 'application/json',
                            data: JSON.stringify(data.finalJson),
                            onSuccess: function (xhr) {
                                if (currentlyDisplayed) {
                                    loadComments(currentlyDisplayed, currentlyDisplayedEl);
                                    submitButton.disabled = false;
                                } else {
                                    const parser = new URL(window.location);
                                    parser.searchParams.set('openInlineCommentId', xhr.responseText);
                                    window.location = parser.href;
                                }
                            },
                            onError: function (xhr) {
                                handleError(xhr);
                            }
                        });
                    }
                }

                function handleError(xhr) {
                    loadInProgress = false;
                    const contentType = (xhr.getResponseHeader('Content-Type') || '').toLowerCase();
                    let errorMessage = 'Unknown error occurred';
                    if (contentType.startsWith('application/json')) {
                        errorMessage = JSON.parse(xhr.response).message || errorMessage
                    }
                    submitButton.disabled = false;
                    inlineCommentFormErrorMessage.innerText = errorMessage;
                    show(inlineCommentFormError);
                    show(inlineCommentFormErrorMessage);
                }

                function req(opts) {
                    const xhr = new XMLHttpRequest();
                    const base = window.origin + window.location.pathname;
                    xhr.open('POST', base + opts.url);

                    xhr.onerror = function () {
                        opts.onError(xhr)
                    };
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4) {
                            const status = xhr.status;
                            if (status === 200) {
                                opts.onSuccess(xhr);
                            } else {
                                opts.onError(xhr);
                            }
                        }
                    };

                    xhr.setRequestHeader('Content-Type', opts.contentType);
                    if (opts.data) {
                        xhr.send(opts.data);
                    } else {
                        xhr.send();
                    }
                }

                function isBlank(str) {
                    return (!str || /^\s*$/.test(str))
                }

                function isEmailValid(email) {
                    return emailRegExp.test(email);
                }

                function hide(element) {
                    if (!!element) {
                        element.style.display = 'none';
                    }
                }

                function show(element) {
                    if (!!element) {
                        element.style.display = 'flex';
                    }
                }

                function scrollToHalfPageHeight(top) {
                    const height = window.innerHeight
                        || document.documentElement.clientHeight
                        || document.body.clientHeight;
                    const halfOfPageHeight = height / 2;

                    if (top > halfOfPageHeight) {
                        const topMinusHalfHeight = top - halfOfPageHeight;
                        const scrollTo = (topMinusHalfHeight < halfOfPageHeight) ? halfOfPageHeight : topMinusHalfHeight;
                        window.scroll({
                            top: scrollTo,
                            behavior: 'smooth'
                        });
                    } else if (top - halfOfPageHeight < 0) {
                        window.scroll({
                            top: 0,
                            behavior: 'smooth'
                        });
                    }
                }

                function isMouseEventInsideElement(event, element) {
                    if (!element) {
                        return false;
                    }
                    let currentElement = event.target;
                    while (currentElement && currentElement !== element) {
                        currentElement = currentElement.parentElement;
                    }
                    return currentElement === element;
                }
            })()
        </script>
<script>
        (function () {
            document.querySelectorAll('span.inline-comment-marker').forEach(el => {
                el.classList.add('visible');
            });
        })()
    </script>
</div>
</div>
</div>
</div></body><br/><br/></html>